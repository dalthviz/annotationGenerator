[comment encoding = UTF-8 /]
[**
 * The documentation of the module docs.
 */]
[module docs('http://www.eclipse.org/uml2/5.0.0/UML')]
[import ::utils /]

[**
 * The documentation of the template mainDocs.
 * @param aModel
 */]
[template public mainDocs(m : Model)]
[m.genReadMe()/]
[/template]

[template protected genReadMe(m : Model)]
[file ('README.md', false, 'UTF-8')]
# Tabla de contenidos
-  ['['/]Introducción[']'/](#introducción)
-  ['['/]API[']'/](#api-de-la-aplicación-[m.name.toLowerCase()/])
[for (c : Class | m.getClasses())]
[if (not c.isChild())]
  - ['['/]Recurso [c.name+']'/](#recurso-[c.name.toLowerCase()/])
    - ['['/]GET /[c.getURI()/][']'/](#GET-/[c.getURI()/])
    - ['['/]GET /[c.getURI()/]/{id}[']'/](#GET-/[c.getURI()/]/{id})
    - ['['/]POST /[c.getURI()/][']'/](#POST-/[c.getURI()/])
    - ['['/]PUT /[c.getURI()/]/{id}[']'/](#PUT-/[c.getURI()/]/{id})
    - ['['/]DELETE /[c.getURI()/]/{id}[']'/](#DELETE-/[c.getURI()/]/{id})
[for (elem : Property | c.getNonCompositeCollectionAttributes())]
    - ['['/]GET [c.getURI()/]/{[c.getURI()/]id}/[elem.name/][']'/](#GET-[c.getURI()/]/{[c.getURI()/]id}/[elem.name/])
    - ['['/]GET [c.getURI()/]/{[c.getURI()/]id}/[elem.name/]/{[elem.name/]id}[']'/](#GET-[c.getURI()/]/{[c.getURI()/]id}/[elem.name/]/{[elem.name/]id})
    - ['['/]POST [c.getURI()/]/{[c.getURI()/]id}/[elem.name/]/{[elem.name/]id}[']'/](#POST-[c.getURI()/]/{[c.getURI()/]id}/[elem.name/]/{[elem.name/]id})
    - ['['/]PUT [c.getURI()/]/{[c.getURI()/]id}/[elem.name/][']'/](#PUT-[c.getURI()/]/{[c.getURI()/]id}/[elem.name/])
    - ['['/]DELETE [c.getURI()/]/{[c.getURI()/]id}/[elem.name/]/{[elem.name/]id}[']'/](#DELETE-[c.getURI()/]/{[c.getURI()/]id}/[elem.name/]/{[elem.name/]id}[']'/])
[/for]
[/if]
[/for]

# API Rest
## Introducción
La comunicación entre cliente y servidor se realiza intercambiando objetos JSON. Para cada entidad se hace un mapeo a JSON, donde cada uno de sus atributos se transforma en una propiedad de un objeto JSON. Todos los servicios se generan en la URL /[m.getApiProjectName()/]/api/. Por defecto, todas las entidades tienen un atributo `id`, con el cual se identifica cada registro:

```javascript
{
    id: '',
    attribute_1: '',
    attribute_2: '',
    ...
    attribute_n: ''
}
```

Cuando se transmite información sobre un registro específico, se realiza enviando un objeto con la estructura mencionada en la sección anterior.
La única excepción se presenta al solicitar al servidor una lista de los registros en la base de datos, que incluye información adicional para manejar paginación de lado del servidor en el header `X-Total-Count` y los registros se envían en el cuerpo del mensaje como un arreglo.

La respuesta del servidor al solicitar una colección presenta el siguiente formato:

```javascript
['['/]{}, {}, {}, {}, {}, {}[']'/]
```

## API de la aplicación [m.name/]
[for(c : Class | m.getClasses()) ]
[if (not c.isChild())]
### Recurso [c.name/]
[if (c.hasReferences(false) and c.hasCompositeAssociations())]
El objeto [c.name/] tiene 3 representaciones JSON:
[elseif (c.hasReferences(false) or c.hasCompositeAssociations())]
El objeto [c.name/] tiene 2 representaciones JSON:	
[/if]

#### Representación Minimum
```javascript
{
    [for(a : Property | c.allAttributes()) separator(',\n')]
    [ a.name /]: '' /*Tipo [ a.type.name /]*/[/for]

}
```

[if (c.hasReferences(false))]
#### Representación Basic
```javascript
{
    // todo lo de la representación Minimum más los objetos Minimum con relación simple.
    [for(a : Property | c.getReferences(false)) separator(',\n')]
    [ a.name /]: {
    [for(a2 : Property | a.getClass().allAttributes()) separator(',\n')]
    [ a2.name /]: '' /*Tipo [ a2.type.name /]*/[/for]
    }[/for]

}
```
[/if]

[if (c.hasCompositeAssociations())]
#### Representación Full
```javascript
{
    // todo lo de la representación Basic más la collección de los objetos de relaciones composite.
    [for(a : Property | c.getCompositeCollectionAttributes()) separator(',\n')]
    [ a.name /]: ['['/]{
    [for(a2 : Property | a.getClass().allAttributes()) separator(',\n')]
    [ a2.name /]: '' /*Tipo [ a2.type.name /]*/[/for]
    }[']'/][/for]

}
```
[/if]


#### GET /[c.getURI()/]

Retorna una colección de objetos [c.name/] en representación Basic.
[if (c.hasReferences(false))] 
Cada [c.name/] en la colección tiene embebidos su objetos [for(a : Property | c.getReferences(false)) separator(', ') after('.')][ a.name /][/for].
[/if]

#### Parámetros

#### N/A

#### Respuesta

Código|Descripción|Cuerpo|
200|OK|Colección de ['['/]representaciones Basic[']'/](#recurso-[c.name.toLowerCase()/])
409|Un objeto relacionado no existe.|Mensaje de error
500|Error interno|Mensaje de error

#### GET /[c.getURI()/]/{id}
#### POST /[c.getURI()/]
#### PUT /[c.getURI()/]/{id}
#### DELETE /[c.getURI()/]/{id}
[for (elem : Property | c.getNonCompositeCollectionAttributes())]
#### GET [c.getURI()/]/{[c.getURI()/]id}/[elem.name/]
#### GET [c.getURI()/]/{[c.getURI()/]id}/[elem.name/]/{[elem.name/]id}
#### POST [c.getURI()/]/{[c.getURI()/]id}/[elem.name/]/{[elem.name/]id}
#### PUT [c.getURI()/]/{[c.getURI()/]id}/[elem.name/]
#### DELETE [c.getURI()/]/{[c.getURI()/]id}/[elem.name/]/{[elem.name/]id}
[/for]

#### Servicios
Método|URI|Acción|Parámetros|Cuerpo|Retorno
:--:|:--:|:--:|:--:|:--:|:--:
**GET**|/[c.getURI()/]|Lista los registros de [c.name/] (READ)|**@QueryParam page**: página a consultar<br>**@QueryParam maxRecords**: cantidad de registros a consultar<br><br>*Si se omite alguno de estos parámetros se obtiene todos los registros en la base de datos*||Colección de registros de [c.name/] y el total de registros en la base de datos en el header X-Total-Count
**GET**|/[c.getURI()/]/*:[c.getURI()/]id*|Obtener los atributos de una instancia de [c.name/] (READ)|**@PathParam [c.getURI()/]id**: Identificador del registro||Atributos de la instancia de [c.name/]
**POST**|/[c.getURI()/]|Crear una nueva instancia de la entidad [c.name/] (CREATE)||Atributos de la instancia de [c.name/] a crear|Instancia de [c.name/] creada, incluyendo su nuevo ID
**PUT**|/[c.getURI()/]/*:[c.getURI()/]id*|Actualiza una instancia de la entidad [c.name/] (UPDATE)|**@PathParam [c.getURI()/]id**: Identificador del registro|Objeto JSON de [c.name/]|Instancia de [c.name/] actualizada
**DELETE**|/[c.getURI()/]/*:[c.getURI()/]id*|Borra instancia de [c.name/] en el servidor (DELETE)|**@PathParam [c.getURI()/]id**: Identificador del registro||
[for (elem : Property | c.getNonCompositeCollectionAttributes())]
**GET**|[c.getURI()/]/*:[c.getURI()/]id*/[elem.name/]|Listar registros de [elem.name/] ([elem.getClass().name/]) asociados a [c.name/]|**@PathParam [c.getURI()/]id**: Identificador de instancia de [c.name/]||Colección de objetos JSON de [elem.name/]([elem.getClass().name/])
**GET**|[c.getURI()/]/*:[c.getURI()/]id*/[elem.name/]/*:[elem.name/]id*|Obtener un registro de [elem.name/] ([elem.getClass().name/]) asociado a [c.name/]|**@PathParam [c.getURI()/]id**: Identificador de instancia de [c.name/]<br><br>**@PathParam [elem.name/]id**: Identificador de instancia de [elem.getClass().name/]||Lista de registros de [elem.name/]([elem.getClass().name/])
**POST**|[c.getURI()/]/*:[c.getURI()/]id*/[elem.name/]/*:[elem.name/]id*|Asocia una instancia de [elem.getClass().name/] a una de [c.name/]|**@PathParam [c.getURI()/]id**: Identificador de instancia de [c.name/]<br><br>**@PathParam [elem.name/]id**: Identificador de instancia de [elem.getClass().name/]|Registro de [elem.name/]([elem.getClass().name/]) para asociar a [c.name/]|Instancia de [elem.name/]([elem.getClass().name/]) asociada a instancia de [c.name/]
**PUT**|[c.getURI()/]/*:[c.getURI()/]id*/[elem.name/]|Actualización de instancias de [elem.name/] ([elem.getClass().name/]) asociadas a [c.name/]|**@PathParam [c.getURI()/]id**: Identificador de instancia de [c.name/]|Colección de instancias de [elem.name/]([elem.getClass().name/]) a actualizar|Colección de instancias de [elem.name/]([elem.getClass().name/]) actualizados
**DELETE**|[c.getURI()/]/*:[c.getURI()/]id*/[elem.name/]/*:[elem.name/]id*|Remueve asociación de instancias de [elem.name/] ([elem.getClass().name/]) a [c.name/]|**@PathParam [c.getURI()/]id**: Identificador de instancia de [c.name/]<br><br>**@PathParam [elem.name/]id**: Identificador de instancia de [elem.getClass().name/]|Colección de atributo `id` de [elem.name/]([elem.getClass().name/]) a eliminar|
[/for]

['['/]Volver arriba[']'/](#tabla-de-contenidos)
[/if]
[/for]
[/file]
[/template]